/**
 * 多数据库连接
 * @module databaseconn
 */ 
var mongoose = require('mongoose');
//数据映射
var management = require('./management.js');
//管理员映射
var authenticment = require('./authenticment.js');
//导出对象
var databaseconn = {
    //认证接口
    auth: {},
    //初始化接口
    data: {},
};
//用户认证
var authorUri = {
    VGIDatabaseDev: 'mongodb://VGISeverPro:vgiserver$0525@172.16.101.153:27017/VGIDatabaseDev',
};
//数据库连接字符串
var dataUri = {
    VGIDatabaseDev: 'mongodb://VGISeverPro:vgiserver$0525@172.16.101.153:27017/VGIDatabaseDev',
};
//认证接口初始化
for (var authorName in authorUri) {
    (function (name) {
        databaseconn.auth[name] = mongoose.createConnection(authorUri[name], {
            server: {
                socketOptions: {
                    keepAlive: 1
                }
            },
            replset: {
                socketOptions : {
                    keepAlive: 1
                }
            }
        }, function (err, data) {
            if (!!err) {
                console.log('连接数据库失败' + JSON.stringify(err));
            } else {
                console.log(name + ' 数据库连接成功');
                authenticment.inilization(databaseconn.auth[name]);
            }
        });
    })(authorName);
}
//数据接口初始化
for (var dataName in dataUri) {
    (function (name) {
        databaseconn.data[name] = mongoose.createConnection(dataUri[name], {
            server: {
                socketOptions: {
                    keepAlive: 1
                }
            },
            replset: {
                socketOptions : {
                    keepAlive: 1
                }
            }
        }, function (err, data) {
            if (!!err) {
                console.log('连接数据库失败' + JSON.stringify(err));
            } else {
                console.log(name + ' 数据库连接成功');
                management.inilization(databaseconn.data[name]);
            }
        });
    })(dataName);
};
//
module.exports = databaseconn;